<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…ƒç¥–ãƒãƒ«ãƒ”ãƒ³ - ã‚«ãƒ¼ãƒˆæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</title>
    <link rel="stylesheet" href="css/main.css">
    <style>
        .test-section {
            padding: 50px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-log {
            background: #f5f5f5;
            border: 2px solid #333;
            padding: 20px;
            margin-top: 20px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .test-button {
            background: var(--black);
            color: var(--white);
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            font-family: 'Bebas Neue', cursive;
            font-size: 1.2rem;
        }
        .test-button:hover {
            background: var(--red);
        }
    </style>
</head>
<body>
    <div class="test-section">
        <h1>ã‚«ãƒ¼ãƒˆæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h1>
        
        <h2>1. ã‚«ãƒ¼ãƒˆæ“ä½œãƒ†ã‚¹ãƒˆ</h2>
        <button class="test-button" onclick="testAddToCart()">å•†å“è¿½åŠ ãƒ†ã‚¹ãƒˆ</button>
        <button class="test-button" onclick="testUpdateQuantity()">æ•°é‡å¤‰æ›´ãƒ†ã‚¹ãƒˆ</button>
        <button class="test-button" onclick="testRemoveItem()">å•†å“å‰Šé™¤ãƒ†ã‚¹ãƒˆ</button>
        <button class="test-button" onclick="testClearCart()">ã‚«ãƒ¼ãƒˆã‚¯ãƒªã‚¢ãƒ†ã‚¹ãƒˆ</button>
        
        <h2>2. ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ†ã‚¹ãƒˆ</h2>
        <button class="test-button" onclick="testLocalStorage()">ä¿å­˜ãƒ»èª­è¾¼ãƒ†ã‚¹ãƒˆ</button>
        
        <h2>3. UIè¡¨ç¤ºãƒ†ã‚¹ãƒˆ</h2>
        <button class="test-button" onclick="testCartUI()">ã‚«ãƒ¼ãƒˆè¡¨ç¤ºãƒ†ã‚¹ãƒˆ</button>
        
        <h2>4. æ±ºæ¸ˆãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆï¼ˆãƒ¢ãƒƒã‚¯ï¼‰</h2>
        <button class="test-button" onclick="testCheckout()">æ±ºæ¸ˆãƒ†ã‚¹ãƒˆ</button>
        
        <div id="test-log" class="test-log">ãƒ†ã‚¹ãƒˆçµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</div>
    </div>

    <!-- æœ¬ç•ªç”¨ã‚«ãƒ¼ãƒˆUI -->
    <div class="cart" id="cart">
        <div class="cart-header">
            <span>YOUR CART</span>
            <span class="cart-close" onclick="toggleCart()">Ã—</span>
        </div>
        <div class="cart-items" id="cart-items"></div>
        <div id="cart-total" style="padding: 30px; font-size: 1.5rem; font-weight: bold;">åˆè¨ˆ: Â¥0</div>
        <button class="checkout-btn" onclick="mockCheckout()">æ±ºæ¸ˆã¸é€²ã‚€ï¼ˆãƒ†ã‚¹ãƒˆï¼‰</button>
    </div>
    
    <div class="floating-cart" onclick="toggleCart()">
        ğŸ›’
        <span class="cart-count" id="cart-count">0</span>
    </div>

    <script>
        const log = (message) => {
            const logDiv = document.getElementById('test-log');
            logDiv.textContent += `[${new Date().toLocaleTimeString()}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        };

        // ãƒ¢ãƒƒã‚¯ã‚«ãƒ¼ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
        class MockCartManager {
            constructor() {
                this.cart = [];
                this.products = {
                    'shrimp-gyoza': {
                        name: 'ä¼èª¬ã®ã‚¨ãƒ“é¤ƒå­',
                        price: 2980,
                        description: 'å…«è§’é¦™ã‚‹æœ¬å ´ã®å‘³ (20å€‹å…¥ã‚Š)'
                    },
                    'xiaolongbao': {
                        name: 'å·¨å¤§å°ç± åŒ…',
                        price: 3480,
                        description: 'ã‚¹ãƒ¼ãƒ—ãŸã£ã·ã‚Š (12å€‹å…¥ã‚Š)'
                    }
                };
                log('MockCartManager initialized');
            }

            addItem(productId, quantity = 1) {
                const product = this.products[productId];
                if (!product) {
                    log(`Error: Product ${productId} not found`);
                    return;
                }

                const existingItem = this.cart.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity += quantity;
                    log(`Updated quantity for ${product.name}: ${existingItem.quantity}`);
                } else {
                    this.cart.push({
                        id: productId,
                        name: product.name,
                        price: product.price,
                        quantity: quantity
                    });
                    log(`Added ${product.name} to cart`);
                }
                this.updateUI();
            }

            updateUI() {
                const cartCount = document.getElementById('cart-count');
                const cartTotal = document.getElementById('cart-total');
                const cartItems = document.getElementById('cart-items');
                
                let total = 0;
                let count = 0;
                
                cartItems.innerHTML = '';
                this.cart.forEach((item, index) => {
                    total += item.price * item.quantity;
                    count += item.quantity;
                    
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'cart-item';
                    itemDiv.innerHTML = `
                        <div>
                            <strong>${item.name}</strong><br>
                            Â¥${item.price.toLocaleString()} Ã— ${item.quantity}
                        </div>
                        <div>Â¥${(item.price * item.quantity).toLocaleString()}</div>
                    `;
                    cartItems.appendChild(itemDiv);
                });
                
                cartCount.textContent = count;
                cartTotal.textContent = `åˆè¨ˆ: Â¥${total.toLocaleString()}`;
                log(`UI updated: ${count} items, Total: Â¥${total}`);
            }
        }

        const mockCart = new MockCartManager();

        // ãƒ†ã‚¹ãƒˆé–¢æ•°
        function testAddToCart() {
            log('=== å•†å“è¿½åŠ ãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            mockCart.addItem('shrimp-gyoza', 2);
            mockCart.addItem('xiaolongbao', 1);
            log('=== å•†å“è¿½åŠ ãƒ†ã‚¹ãƒˆå®Œäº† ===');
        }

        function testUpdateQuantity() {
            log('=== æ•°é‡å¤‰æ›´ãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            if (mockCart.cart.length > 0) {
                const item = mockCart.cart[0];
                item.quantity = 5;
                log(`${item.name}ã®æ•°é‡ã‚’5ã«å¤‰æ›´`);
                mockCart.updateUI();
            } else {
                log('ã‚«ãƒ¼ãƒˆãŒç©ºã§ã™ã€‚å…ˆã«å•†å“ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚');
            }
            log('=== æ•°é‡å¤‰æ›´ãƒ†ã‚¹ãƒˆå®Œäº† ===');
        }

        function testRemoveItem() {
            log('=== å•†å“å‰Šé™¤ãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            if (mockCart.cart.length > 0) {
                const removed = mockCart.cart.pop();
                log(`${removed.name}ã‚’å‰Šé™¤ã—ã¾ã—ãŸ`);
                mockCart.updateUI();
            } else {
                log('ã‚«ãƒ¼ãƒˆãŒç©ºã§ã™ã€‚');
            }
            log('=== å•†å“å‰Šé™¤ãƒ†ã‚¹ãƒˆå®Œäº† ===');
        }

        function testClearCart() {
            log('=== ã‚«ãƒ¼ãƒˆã‚¯ãƒªã‚¢ãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            mockCart.cart = [];
            mockCart.updateUI();
            log('ã‚«ãƒ¼ãƒˆã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
            log('=== ã‚«ãƒ¼ãƒˆã‚¯ãƒªã‚¢ãƒ†ã‚¹ãƒˆå®Œäº† ===');
        }

        function testLocalStorage() {
            log('=== ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            
            // ä¿å­˜
            localStorage.setItem('test-cart', JSON.stringify(mockCart.cart));
            log('ã‚«ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¾ã—ãŸ');
            
            // èª­è¾¼
            const saved = JSON.parse(localStorage.getItem('test-cart') || '[]');
            log(`ä¿å­˜ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿: ${JSON.stringify(saved)}`);
            
            // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
            localStorage.removeItem('test-cart');
            log('ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
            
            log('=== ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ†ã‚¹ãƒˆå®Œäº† ===');
        }

        function testCartUI() {
            log('=== ã‚«ãƒ¼ãƒˆUIè¡¨ç¤ºãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            document.getElementById('cart').classList.add('open');
            log('ã‚«ãƒ¼ãƒˆã‚’é–‹ãã¾ã—ãŸ');
            setTimeout(() => {
                document.getElementById('cart').classList.remove('open');
                log('ã‚«ãƒ¼ãƒˆã‚’é–‰ã˜ã¾ã—ãŸ');
                log('=== ã‚«ãƒ¼ãƒˆUIè¡¨ç¤ºãƒ†ã‚¹ãƒˆå®Œäº† ===');
            }, 2000);
        }

        function testCheckout() {
            log('=== æ±ºæ¸ˆãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
            if (mockCart.cart.length === 0) {
                log('Error: ã‚«ãƒ¼ãƒˆãŒç©ºã§ã™');
                return;
            }
            
            const checkoutData = {
                items: mockCart.cart,
                total: mockCart.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0)
            };
            
            log(`æ±ºæ¸ˆãƒ‡ãƒ¼ã‚¿: ${JSON.stringify(checkoutData, null, 2)}`);
            log('Stripe Checkoutã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¾ã™ï¼ˆãƒ¢ãƒƒã‚¯ï¼‰');
            log('=== æ±ºæ¸ˆãƒ†ã‚¹ãƒˆå®Œäº† ===');
        }

        function toggleCart() {
            document.getElementById('cart').classList.toggle('open');
        }

        function mockCheckout() {
            alert('ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆç’°å¢ƒã§ã™ã€‚æœ¬ç•ªç’°å¢ƒã§ã¯Stripe Checkoutã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã¾ã™ã€‚');
            log('æ±ºæ¸ˆãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã¾ã—ãŸï¼ˆãƒ¢ãƒƒã‚¯ï¼‰');
        }

        // åˆæœŸãƒ­ã‚°
        log('ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ');
        log('å„ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„');
    </script>
</body>
</html>